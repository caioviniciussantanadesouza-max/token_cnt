<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CNT — Reserva Ambiental Tokenizada</title>

<style>
:root{
  --bg:#000;                 /* FUNDO TOTAL PRETO */
  --panel: rgba(6,14,18,.58);
  --stroke: rgba(120,220,255,.20);
  --text: #d7fbff;
  --muted:#86dcff;
  --accent:#7fe3ff;
  --shadow: 0 0 22px rgba(110,210,255,.12), 0 0 70px rgba(0,200,255,.06);
}

html,body{
  margin:0;
  height:100%;
  background:var(--bg);
  color:var(--text);
  font-family:"Segoe UI", Arial, sans-serif;
  overflow:hidden;
}

/* ===== FUNDO PRETO + VINHETA ===== */
#bgBlack{
  position:fixed;
  inset:0;
  background:#000;
  z-index:0;
}
#vignette{
  position:fixed;
  inset:0;
  pointer-events:none;
  z-index:1;
  background:
    radial-gradient(circle at 50% 45%,
      rgba(0,0,0,0) 0%,
      rgba(0,0,0,.15) 45%,
      rgba(0,0,0,.55) 75%,
      rgba(0,0,0,.78) 100%);
}

/* ===== JANELA DO MAPA (monitor preto) ===== */
#mapFrame{
  position:fixed;
  left:50%;
  top:50%;
  transform:translate(-50%,-46%);
  width:min(980px, 62vw);
  height:min(680px, 72vh);
  border-radius:22px;
  z-index:2;

  background: rgba(0,0,0,.84);
  border:1px solid rgba(120,220,255,.18);
  box-shadow: 0 0 40px rgba(0,0,0,.65), 0 0 70px rgba(0,200,255,.08);
  overflow:hidden;
}

/* glow suave dentro do frame */
#mapFrame::before{
  content:"";
  position:absolute; inset:0;
  background:
    radial-gradient(circle at 50% 45%, rgba(120,220,255,.10), transparent 55%),
    radial-gradient(circle at 20% 30%, rgba(120,220,255,.06), transparent 55%),
    radial-gradient(circle at 80% 55%, rgba(120,220,255,.05), transparent 60%);
  opacity:.55;
  pointer-events:none;
  mix-blend-mode:screen;
}

/* MAPA */
#bgMap{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:contain;
  object-position:center;
  transform: translateY(26px) scale(.92);
  filter: brightness(.92) contrast(1.18) saturate(1.22);
  animation: mapPulse 9s ease-in-out infinite;
  opacity: .98;
}
@keyframes mapPulse{
  0%   { filter:brightness(.82) contrast(1.12) saturate(1.10); }
  50%  { filter:brightness(1.07) contrast(1.33) saturate(1.32); }
  100% { filter:brightness(.82) contrast(1.12) saturate(1.10); }
}

/* scanlines dentro do frame */
#scanlines{
  position:absolute; inset:0;
  pointer-events:none;
  opacity:.18;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(120,220,255,.06) 0px,
      rgba(120,220,255,.06) 1px,
      transparent 2px,
      transparent 7px
    );
  mix-blend-mode: overlay;
  animation: scan 3.2s linear infinite;
}
@keyframes scan{
  0%{ transform:translateY(-20px); }
  100%{ transform:translateY(20px); }
}

/* poeira/partículas dentro do frame */
#dust{
  position:absolute; inset:-30%;
  pointer-events:none;
  opacity:.55;
  background:
    radial-gradient(circle at 25% 25%, rgba(120,220,255,.10), transparent 40%),
    radial-gradient(circle at 70% 20%, rgba(120,220,255,.08), transparent 45%),
    radial-gradient(circle at 45% 80%, rgba(120,220,255,.06), transparent 50%);
  filter: blur(2px);
  animation: drift 18s linear infinite;
}
@keyframes drift{
  0%{ transform:translate3d(0,0,0); }
  100%{ transform:translate3d(-3%,2%,0); }
}

/* ===== GLASS PANELS ===== */
.glass{
  background: var(--panel);
  backdrop-filter: blur(14px);
  border:1px solid var(--stroke);
  border-radius:18px;
  box-shadow: var(--shadow);
}

/* ===== HEADER (status do ativo) ===== */
#header{
  position:fixed;
  top:16px;
  left:50%;
  transform:translateX(-50%);
  z-index:10;
  padding:12px 16px;
  border-radius:14px;
  max-width:720px;
  min-width:420px;
}
#header .t1{
  font-weight:900;
  letter-spacing:.8px;
  font-size:22px;
}
#header .t2{
  margin-top:6px;
  font-size:12px;
  color:var(--muted);
  opacity:.95;
}
.badges{
  margin-top:8px;
  display:flex;
  gap:8px;
  flex-wrap:wrap;
}
.badge{
  font-size:11px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(120,220,255,.22);
  background: rgba(0,0,0,.18);
  color:#dffaff;
  opacity:.95;
}

/* ===== PAINEL ESQUERDO (certificação) ===== */
#leftPanel{
  position:fixed;
  left:16px;
  top:16px;
  width:380px;
  padding:16px;
  border-radius:22px;
  z-index:10;
}
.kicker{
  font-size:12px;
  color:var(--muted);
  opacity:.95;
}
.big{
  margin-top:10px;
  font-size:78px;
  font-weight:250;
  line-height:1;
}
.unit{
  font-size:12px;
  color:var(--muted);
  margin-top:4px;
}
.classRow{
  margin-top:10px;
  display:flex;
  gap:10px;
  align-items:center;
  flex-wrap:wrap;
}
.classPill{
  font-size:11px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(120,220,255,.18);
  background: rgba(0,0,0,.16);
  color:#e8fdff;
}
.divider{
  height:1px;
  background:linear-gradient(90deg,transparent,rgba(110,210,255,.25),transparent);
  margin:12px 0;
}
strong{ color:#e8fdff; }

.grid2{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:8px 10px;
  margin-top:10px;
}
.kv{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  padding:9px 10px;
  border:1px solid rgba(110,210,255,.16);
  border-radius:12px;
  background:rgba(0,0,0,.16);
  cursor:pointer;
  user-select:none;
}
.kv:hover{
  border-color: rgba(110,210,255,.35);
  box-shadow: 0 0 14px rgba(110,210,255,.18);
}
.kv b{
  font-weight:900;
  letter-spacing:.4px;
  color:#e9fdff;
}
.kv span{ color:#d0fbff; font-weight:800; }

.note{
  margin-top:10px;
  font-size:11px;
  color:var(--muted);
  opacity:.95;
  line-height:1.25;
}

/* ===== DIREITA (Mercado/Compra + Telemetria) ===== */
#rightWrap{
  position:fixed;
  right:16px;
  top:16px;
  width:380px;
  z-index:10;

  display:flex;
  flex-direction:column;
  gap:12px;
}

#buyPanel{
  padding:14px;
  border-radius:18px;
}
.title{
  font-weight:900;
  letter-spacing:.6px;
  margin-bottom:8px;
}
.subtitle{
  font-size:12px;
  color:var(--muted);
  opacity:.95;
  margin-bottom:10px;
}

label{ display:block; font-size:12px; color:var(--muted); margin:10px 0 6px; }
.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

input{
  width:170px;
  padding:10px 10px;
  border-radius:12px;
  border:1px solid rgba(110,210,255,.38);
  background:rgba(0,0,0,.22);
  color:#e9fbff;
  outline:none;
}
input:focus{
  border-color: rgba(110,210,255,.65);
  box-shadow: 0 0 16px rgba(110,210,255,.18);
}

.btn{
  background:linear-gradient(180deg,rgba(110,210,255,.18),rgba(0,0,0,.18));
  border:1px solid rgba(110,210,255,.45);
  color:#eafcff;
  border-radius:14px;
  padding:10px 14px;
  cursor:pointer;
  font-weight:800;
}
.btn:hover{ box-shadow:0 0 18px rgba(110,210,255,.30); }
.btn.secondary{ opacity:.95; }

.valueLine{ margin-top:10px; font-size:12px; color:#bdf4ff; }
.valueLine b{ font-size:18px; color:#e9fdff; }
.smallline{ margin-top:6px; font-size:11px; color:var(--muted); opacity:.95; }

#telemetry{
  padding:10px 14px;
  border-radius:18px;
}
#telemetryTitle{
  font-size:11px;
  letter-spacing:.8px;
  color:#d4fbff;
  opacity:.95;
  margin-bottom:6px;
}
#telemetryHint{
  font-size:11px;
  color:var(--muted);
  opacity:.90;
  margin-top:6px;
}
#wave{
  width:100%;
  height:44px;
  display:block;
  filter: drop-shadow(0 0 8px rgba(110,210,255,.55));
}

/* ===== MODAL ===== */
#modalOverlay{
  position:fixed; inset:0;
  background: rgba(0,0,0,.55);
  backdrop-filter: blur(2px);
  display:none;
  z-index:50;
}
#modal{
  position:fixed;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:min(560px, 92vw);
  padding:16px;
  border-radius:18px;
  z-index:60;
  display:none;
}
#modal h3{ margin:0 0 6px; letter-spacing:.6px; }
#modal .mtext{ color:#c9f7ff; font-size:13px; line-height:1.35; }
#modal .closeRow{ display:flex; justify-content:flex-end; margin-top:12px; }

/* ===== RESPONSIVO ===== */
@media (max-width: 1200px){
  #leftPanel, #rightWrap{ width:350px; }
  #mapFrame{ width:min(900px, 58vw); }
}
@media (max-width: 980px){
  body{ overflow:auto; }
  #leftPanel{ position:static; width:auto; margin:12px; }
  #header{ position:static; transform:none; margin:12px; }
  #rightWrap{ position:static; width:auto; margin:12px; }
  #mapFrame{
    position:relative;
    left:auto; top:auto;
    transform:none;
    margin:12px;
    width:auto;
    height:55vh;
  }
}
</style>
</head>

<body>

<div id="bgBlack"></div>
<div id="vignette"></div>

<!-- MAPA EM FRAME PRETO -->
<div id="mapFrame">
  <img id="bgMap" src="./mapa_br.png" alt="Mapa CNT Brasil">
  <div id="scanlines"></div>
  <div id="dust"></div>
</div>

<!-- HEADER (venda + confiança) -->
<div id="header" class="glass">
  <div class="t1">CNT — Reserva Ambiental Tokenizada</div>
  <div class="t2">
    Ativo ambiental negociável (estilo carbono): lastro em conservação + monitoramento contínuo + registro público de aquisição.
  </div>
  <div class="badges">
    <span class="badge">Oracle ecológico (DEMO)</span>
    <span class="badge">Telemetria 30D</span>
    <span class="badge">Ajustes: ENT/PAN</span>
    <span class="badge">Rede: Solana</span>
  </div>
</div>

<!-- ESQUERDA (certificação do ativo) -->
<div id="leftPanel" class="glass">
  <div class="kicker">
    <strong>CNT (Solana)</strong>: participação digital em uma reserva ambiental monitorada.
    Compra financia conservação e registra ordem pública de aquisição/monitoramento.
  </div>

  <div class="big" id="cnt">68.0</div>
  <div class="unit">ECO RATING (0–100) • Integridade ecológica do território</div>

  <div class="classRow">
    <span class="classPill" id="classPill">Classe: Moderada</span>
    <span class="classPill">Confiança: Média</span>
    <span class="classPill">Status: Funcional</span>
  </div>

  <div class="divider"></div>

  <div class="kicker">O rating é calculado por sub-índices:</div>

  <div class="grid2">
    <div class="kv" data-k="IBE"><b>IBE</b><span id="ibe">88</span></div>
    <div class="kv" data-k="IAB"><b>IAB</b><span id="iab">88</span></div>
    <div class="kv" data-k="IBI"><b>IBI</b><span id="ibi">11</span></div>
    <div class="kv" data-k="HID"><b>HID</b><span id="hid">83</span></div>
    <div class="kv" data-k="ENT"><b>ENT</b><span id="ent">88</span></div>
    <div class="kv" data-k="PAN"><b>PAN</b><span id="pan">78</span></div>
  </div>

  <div class="note">
    Nota técnica: ENT (entropia) e PAN (pressão antrópica) atuam como fatores de ajuste
    (penalidades/pressões) e modulam o CNT final junto aos demais índices.
  </div>
</div>

<!-- DIREITA (mercado + telemetria como validade) -->
<div id="rightWrap">
  <div id="buyPanel" class="glass">
    <div class="title">ADQUIRIR CNT (RESERVA AMBIENTAL)</div>
    <div class="subtitle">
      O CNT representa frações de integridade ecológica monitorada.
      A telemetria valida estabilidade ao longo do tempo.
    </div>

    <label for="sol">Valor em SOL</label>
    <div class="row">
      <input id="sol" type="number" step="0.01" min="0" value="0.10" />
      <button class="btn secondary" onclick="connect()">Conectar Wallet</button>
      <button class="btn" onclick="buy()">Comprar</button>
    </div>

    <div class="valueLine">
      Você recebe aprox: <b id="out">14.744.913 CNT</b>
    </div>
    <div class="smallline">Rede: Solana • Compra abre Pump.fun • (DEMO de interface)</div>
  </div>

  <div id="telemetry" class="glass">
    <div id="telemetryTitle">TELEMETRIA — VALIDADE TEMPORAL (30D)</div>
    <canvas id="wave"></canvas>
    <div id="telemetryHint">
      Interpretação: estabilidade alta = ativo mais confiável • instabilidade = risco/pressão no sistema.
    </div>
  </div>
</div>

<!-- MODAL -->
<div id="modalOverlay"></div>
<div id="modal" class="glass">
  <h3 id="mTitle">IBE</h3>
  <div class="mtext" id="mText"></div>
  <div class="closeRow">
    <button class="btn secondary" id="closeBtn">Fechar</button>
  </div>
</div>

<script>
/* ===== FIX IMAGEM (GitHub Pages) ===== */
(function(){
  const bg = document.getElementById("bgMap");
  const base = "./mapa_br.png";
  if(!bg) return;

  bg.src = base + "?v=" + Date.now();

  bg.addEventListener("load", () => console.log("OK: mapa carregou:", bg.src));
  bg.addEventListener("error", () => {
    console.error("ERRO: não encontrei:", base);
    alert("ERRO: não achei ./mapa_br.png. Coloque o arquivo na MESMA pasta do index.html e com o nome EXATO.");
  });
})();

/* ===== Telemetria ===== */
const canvas = document.getElementById("wave");
const ctx = canvas.getContext("2d");

function resize(){
  const dpr = Math.max(1, window.devicePixelRatio || 1);
  canvas.width = Math.floor(canvas.clientWidth * dpr);
  canvas.height = Math.floor(canvas.clientHeight * dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener("resize", resize);
resize();

let tt=0;
function draw(){
  const w = canvas.clientWidth;
  const h = canvas.clientHeight;

  // fundo do gráfico
  ctx.fillStyle = "rgba(0,0,0,.55)";
  ctx.fillRect(0,0,w,h);

  // linha principal
  ctx.strokeStyle = "#7fe3ff";
  ctx.lineWidth = 2;
  ctx.beginPath();

  for(let i=0;i<w;i++){
    const y =
      (h*0.58)
      + Math.sin((i+tt)/38)*(h*0.22)
      + Math.sin((i+tt)/13)*(h*0.08);

    if(i===0) ctx.moveTo(i,y);
    else ctx.lineTo(i,y);
  }
  ctx.stroke();

  // brilho leve
  ctx.strokeStyle = "rgba(127,227,255,.25)";
  ctx.lineWidth = 6;
  ctx.stroke();

  tt += 2;
  requestAnimationFrame(draw);
}
draw();

/* ===== Conversão DEMO ===== */
const rate = 147449130; // 1 SOL -> CNT (demo)
const solInput = document.getElementById("sol");
const out = document.getElementById("out");
function update(){
  const sol = parseFloat(solInput.value) || 0;
  out.textContent = (sol * rate).toLocaleString("pt-BR") + " CNT";
}
solInput.addEventListener("input", update);
update();

/* ===== Botões (placeholder) ===== */
function connect(){
  alert("Conexão Phantom/Solana entra aqui depois (ainda é DEMO).");
}
function buy(){
  window.open("https://pump.fun/coin/GCVyjNaCbXkwGUuktyNxSXad4ozmTp2fzQr2jieSpump","_blank");
}

/* ===== Modal Sub-índices ===== */
const meanings = {
  IBE: "Índice Bioelétrico: metabolismo do sistema (pulso funcional/ecológico).",
  IAB: "Índice Abiótico: suporte físico (clima, solo, energia) que sustenta o sistema.",
  IBI: "Índice Biótico: organização da vida (atividade biológica e padrão funcional).",
  HID: "Índice Hídrico: estabilidade e dinâmica da água no território.",
  ENT: "Entropia: perda de ordem/eficiência do sistema (penalidade/ajuste).",
  PAN: "Pressão Antrópica: intensidade do uso humano e impacto (penalidade/ajuste)."
};

const modal = document.getElementById("modal");
const overlay = document.getElementById("modalOverlay");
const mTitle = document.getElementById("mTitle");
const mText  = document.getElementById("mText");
const closeBtn = document.getElementById("closeBtn");

function openModal(key){
  mTitle.textContent = key;
  mText.textContent = meanings[key] || "Sem descrição.";
  overlay.style.display = "block";
  modal.style.display = "block";
}
function closeModal(){
  overlay.style.display = "none";
  modal.style.display = "none";
}
document.querySelectorAll(".kv").forEach(el=>{
  el.addEventListener("click", ()=> openModal(el.dataset.k));
});
overlay.addEventListener("click", closeModal);
closeBtn.addEventListener("click", closeModal);
</script>

</body>
</html>
