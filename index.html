<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>OS.CNT — Observatório Ambiental</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
html,body{
    margin:0;
    height:100%;
    background:#01040a;
    font-family:Segoe UI, Arial;
    color:#9fdfff;
    overflow:hidden;
}

/* MAPA */
#map{ position:absolute; inset:0; }

#bg{
    position:absolute;
    inset:0;
    width:100%;
    height:100%;
    object-fit:cover;
    animation:biome 18s ease-in-out infinite;
}

/* respiração ecológica */
@keyframes biome{
    0%{ filter:brightness(.85) contrast(1.15) saturate(1.1); }
    50%{ filter:brightness(.95) contrast(1.25) saturate(1.25); }
    100%{ filter:brightness(.85) contrast(1.15) saturate(1.1); }
}

/* HUD */
.hud{ position:absolute; inset:0; pointer-events:none; z-index:5; }
.hud:before{
    content:"";
    position:absolute;
    inset:14px;
    border:1px solid rgba(120,220,255,.06);
}

/* PAINEIS */
.glass{
    position:absolute;
    background:transparent;
    border:none;
    padding:18px;
    z-index:10;
    text-shadow:0 0 6px rgba(120,220,255,.35);
}

#status{ top:20px; left:20px; width:280px; }
#telemetry{ top:20px; left:340px; right:260px; height:120px; }
#indices{ top:20px; right:20px; width:200px; line-height:26px; }

#psa{
    bottom:20px;
    left:50%;
    transform:translateX(-50%);
    width:420px;
    text-align:center;
}

/* CNT */
#cnt{
    font-size:56px;
    letter-spacing:4px;
    font-weight:300;
    text-shadow:
        0 0 10px rgba(120,220,255,.7),
        0 0 24px rgba(0,200,255,.35);
    animation:pulse 14s ease-in-out infinite;
}

@keyframes pulse{
    0%{opacity:.85}
    50%{opacity:1}
    100%{opacity:.85}
}

input,button{
    background:rgba(255,255,255,.05);
    border:1px solid rgba(120,220,255,.3);
    color:#9fdfff;
    padding:6px;
    margin-top:6px;
}

button:hover{ background:rgba(120,220,255,.15); cursor:pointer; }
</style>
</head>

<body>

<div id="map">
    <img src="imagem_cnt.png" id="bg">
</div>

<div class="hud"></div>

<div id="status" class="glass">
<b>OS.CNT</b><br>
Earth Environmental Monitoring Infrastructure<br><br>
<div id="cnt">72.4</div>
Confiança: Alta<br><br>
Estado do sistema:<br>
<b>Regulação estável</b><br>
Modo operacional: Monitoramento ativo<br>
Status: Operacional
</div>

<div id="telemetry" class="glass"></div>

<div id="indices" class="glass">
IBE .......... 88<br>
IAB .......... 88<br>
IBI .......... 11<br>
HID .......... 83<br>
ENT .......... 88<br>
PAN .......... 78
</div>

<!-- COMPRA TOKEN -->
<div id="psa" class="glass">
<div id="walletStatus">Carteira não conectada</div><br>

<button id="connectBtn">Conectar carteira</button><br><br>

Valor em SOL:<br>
<input id="amount" type="number" value="0.1" step="0.01"><br><br>

<button id="buyBtn">Comprar CNT</button>
</div>

<!-- bibliotecas -->
<script src="https://unpkg.com/@solana/web3.js@latest/lib/index.iife.js"></script>

<script>
const { Connection, PublicKey, clusterApiUrl, Transaction } = solanaWeb3;

let provider=null;
let wallet=null;
const connection=new Connection(clusterApiUrl("mainnet-beta"));

document.getElementById("connectBtn").onclick=async()=>{
    if(window.solana){
        provider=window.solana;
        await provider.connect();
        wallet=provider.publicKey.toString();
        document.getElementById("walletStatus").innerText=
        "Conectado: "+wallet.slice(0,4)+"..."+wallet.slice(-4);
    }else{
        alert("Instale Phantom Wallet");
    }
};

document.getElementById("buyBtn").onclick=async()=>{
    if(!wallet) return alert("Conecte a carteira primeiro");

    const amount=parseFloat(document.getElementById("amount").value);

    const TOKEN_MINT="COLOQUE_O_ENDERECO_DO_TOKEN_AQUI";

    const quote=await fetch(`https://quote-api.jup.ag/v6/quote?inputMint=So11111111111111111111111111111111111111112&outputMint=${TOKEN_MINT}&amount=${amount*1e9}&slippageBps=50`).then(r=>r.json());

    const swap=await fetch("https://quote-api.jup.ag/v6/swap",{
        method:"POST",
        headers:{ "Content-Type":"application/json" },
        body:JSON.stringify({
            quoteResponse:quote,
            userPublicKey:wallet,
            wrapAndUnwrapSol:true
        })
    }).then(r=>r.json());

    const tx=Transaction.from(atob(swap.swapTransaction));
    tx.feePayer=new PublicKey(wallet);

    const signed=await provider.signTransaction(tx);
    const sig=await connection.sendRawTransaction(signed.serialize());

    alert("Transação enviada: "+sig);
};
</script>

</body>
</html>
