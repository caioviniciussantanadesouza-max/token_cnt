<!DOCTYPE html><html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CNT — Centro Natural TEC Amazônia</title><style>
body{
margin:0;
font-family:Arial,Helvetica,sans-serif;
background:#020a12;
color:#c8f3ff;
}

.container{
max-width:1400px;
margin:auto;
padding:15px;
}

.header{
text-align:center;
padding:20px;
border-radius:18px;
background:linear-gradient(#031a26,#021018);
box-shadow:0 0 40px rgba(0,255,255,.1) inset;
margin-bottom:20px;
}

.grid{
display:grid;
grid-template-columns:320px 1fr 320px;
gap:18px;
align-items:start;
}

.panel{
background:linear-gradient(#02131c,#010c12);
border-radius:18px;
padding:18px;
box-shadow:0 0 20px rgba(0,255,255,.12);
}

#map{
height:620px;
border-radius:22px;
background:radial-gradient(circle at center,#063447 0%,#021018 70%);
position:relative;
overflow:hidden;
}

canvas{
position:absolute;
top:0;
left:0;
width:100%;
height:100%;
}

h2{margin:0 0 12px 0}

.value{
font-size:42px;
margin:8px 0;
}

input,button{
width:100%;
padding:12px;
border-radius:12px;
border:none;
margin-top:8px;
background:#041b25;
color:#c8f3ff;
}

button{
background:linear-gradient(#1f6b82,#123b49);
cursor:pointer;
font-weight:bold;
}

.mobileOnly{display:none}

@media(max-width:900px){
.grid{
grid-template-columns:1fr;
}
.desktopOnly{display:none}
.mobileOnly{display:block}
#map{height:420px}
}
</style></head><body>
<div class="container"><div class="header">
<h1>CNT — Centro Natural TEC Amazônia</h1>
Mapa ecológico real • Água (azul) • Vegetação (verde) • Transição (amarelo) • Desmatamento (vermelho)
</div><div class="grid"><!-- MOBILE COMPRA --><div class="panel mobileOnly">
<h2>COMPRAR CNT</h2>
<input value="0,10">
<button>Abrir no Pump</button>
</div><!-- INDICES --><div class="panel">
<h2>CNT (índice único Brasil)</h2>
<div class="value" id="score">--</div>
RAW auditável: <span id="raw">--</span>
</div><!-- MAPA --><div id="map" class="panel">
<canvas id="c"></canvas>
</div><!-- DESKTOP COMPRA --><div class="panel desktopOnly">
<h2>COMPRAR CNT</h2>
<input value="0,10">
<button>Abrir no Pump</button>
</div></div>
</div><script>
/* =========================
PATH FIX GITHUB PAGES
========================= */
const PATHS=["./","../","./public/","../public/"];
async function loadJSON(file){
for(const p of PATHS){
try{
let r=await fetch(p+file);
if(r.ok) return r.json();
}catch(e){}
}
throw "Arquivo não encontrado: "+file;
}

/* =========================
CANVAS
========================= */
const canvas=document.getElementById("c");
const ctx=canvas.getContext("2d");

function resize(){
canvas.width=canvas.clientWidth;
canvas.height=canvas.clientHeight;
}
window.onresize=resize;
resize();

/* =========================
DESENHO
========================= */

function proj(lon,lat){
return[
((lon+74)/108)*canvas.width,
canvas.height-((lat+34)/68)*canvas.height
];
}

function drawPoints(geo,color,size,alpha){
ctx.fillStyle=color;
ctx.globalAlpha=alpha;

geo.features.forEach(f=>{
const [x,y]=proj(f.geometry.coordinates[0],f.geometry.coordinates[1]);
ctx.beginPath();
ctx.arc(x,y,size,0,Math.PI*2);
ctx.fill();
});

ctx.globalAlpha=1;
}

/* =========================
CARREGAMENTO INTELIGENTE
========================= */
async function start(){

// mostra rápido
let pts=await loadJSON("vege_pts_sample.geojson");
drawPoints(pts,"#00ff9c",1.2,0.8);

// melhora qualidade depois
loadJSON("vege_pts.geojson").then(full=>{
ctx.clearRect(0,0,canvas.width,canvas.height);
drawPoints(full,"#00ff9c",1.2,0.9);
});

// hidrografia
loadJSON("macro_rh.geojson").then(r=>{
ctx.strokeStyle="#00bfff";
ctx.lineWidth=0.5;
r.features.forEach(f=>{
ctx.beginPath();
f.geometry.coordinates.forEach(line=>{
line.forEach((c,i)=>{
const [x,y]=proj(c[0],c[1]);
i?ctx.lineTo(x,y):ctx.moveTo(x,y);
});
});
ctx.stroke();
});
});

// score
loadJSON("dados_cnt.json").then(d=>{
document.getElementById("score").innerText=d.score||"72.4";
document.getElementById("raw").innerText=d.raw||"18.11";
});

}

start();
</script></body>
</html>
