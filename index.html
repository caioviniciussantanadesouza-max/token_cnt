<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>CNT — Ativo Ambiental Tokenizado</title>

<style>
:root{
  --bgSolid:#0f3f48;

  --stroke: rgba(110,210,255,.20);
  --glass: rgba(2,12,24,.34);
  --text: #c8f3ff;
  --muted:#86dcff;
  --shadow: 0 0 22px rgba(110,210,255,.12), 0 0 70px rgba(0,200,255,.06);
}

html,body{
  margin:0;
  height:100%;
  background:var(--bgSolid);
  color:var(--text);
  font-family:"Segoe UI", Arial, sans-serif;
  overflow:hidden;
}

/* ===== MAPA ===== */
#stage{
  position:fixed;
  inset:0;
  z-index:0;
  background:var(--bgSolid);
}

#bg{
  position:absolute; inset:0;
  width:100%; height:100%;
  object-fit:contain;
  object-position:center;

  /* dá respiro e evita “encostar” no header */
  transform: translateY(28px) scale(.86);

  opacity:.98;
  filter: brightness(.92) contrast(1.18) saturate(1.15);
  animation: biome 10s ease-in-out infinite;
}

@keyframes biome{
  0%   { filter:brightness(.86) contrast(1.14) saturate(1.08); }
  50%  { filter:brightness(1.05) contrast(1.28) saturate(1.28); }
  100% { filter:brightness(.86) contrast(1.14) saturate(1.08); }
}

#mapGlow{
  position:absolute; inset:0;
  pointer-events:none;
  mix-blend-mode: screen;
  opacity:.32;
  filter: blur(10px);
  background:
    radial-gradient(circle at 40% 55%, rgba(120,220,255,.22), transparent 55%),
    radial-gradient(circle at 70% 45%, rgba(120,220,255,.16), transparent 60%);
  animation: glowPulse 6s ease-in-out infinite;
}
@keyframes glowPulse{
  0%{ opacity:.20; transform:scale(1); }
  50%{ opacity:.38; transform:scale(1.02); }
  100%{ opacity:.20; transform:scale(1); }
}

#scanlines{
  position:absolute; inset:0;
  pointer-events:none;
  opacity:.22;
  background:
    repeating-linear-gradient(
      to bottom,
      rgba(120,220,255,.06) 0px,
      rgba(120,220,255,.06) 1px,
      transparent 2px,
      transparent 6px
    );
  mix-blend-mode: overlay;
  animation: scan 3.2s linear infinite;
}
@keyframes scan{
  0%{ transform:translateY(-20px); }
  100%{ transform:translateY(20px); }
}

#dust{
  position:absolute; inset:-20%;
  background:
    radial-gradient(circle at 20% 30%, rgba(120,220,255,.12), transparent 35%),
    radial-gradient(circle at 70% 20%, rgba(120,220,255,.10), transparent 40%),
    radial-gradient(circle at 40% 80%, rgba(120,220,255,.08), transparent 45%);
  filter: blur(2px);
  opacity:.6;
  animation: drift 18s linear infinite;
  pointer-events:none;
}
@keyframes drift{
  0%{ transform:translate3d(0,0,0); }
  100%{ transform:translate3d(-3%,2%,0); }
}

/* ===== GLASS ===== */
.glass{
  background:var(--glass);
  backdrop-filter: blur(14px);
  border:1px solid var(--stroke);
  border-radius:18px;
  box-shadow: var(--shadow);
}

/* ===== HEADER topo centro ===== */
#header{
  position:fixed;
  top:16px;
  left:50%;
  transform:translateX(-50%);
  padding:12px 16px;
  border-radius:14px;
  max-width:620px;
  min-width:380px;
  z-index:11;
}
#header .t1{
  font-weight:900;
  letter-spacing:.8px;
  font-size:22px;
  color:#d7fbff;
}
#header .t2{
  margin-top:6px;
  font-size:12px;
  color:var(--muted);
  opacity:.95;
}

/* ===== PAINEL ESQUERDO ===== */
#leftPanel{
  position:fixed;
  left:16px;
  top:16px;
  width:360px;
  padding:16px;
  border-radius:22px;
  z-index:10;
}
.big{
  font-size:78px;
  font-weight:260;
  line-height:1;
  margin:8px 0 0;
  color:#d9fbff;
}
.small{ font-size:12px; color:var(--muted); opacity:.95; }
.divider{
  height:1px;
  background:linear-gradient(90deg,transparent,rgba(110,210,255,.25),transparent);
  margin:12px 0;
}
strong{ color:#e8fdff; }

.grid2{
  display:grid;
  grid-template-columns: 1fr 1fr;
  gap:8px 10px;
  margin-top:10px;
}
.kv{
  display:flex;
  justify-content:space-between;
  align-items:center;
  font-size:12px;
  padding:9px 10px;
  border:1px solid rgba(110,210,255,.16);
  border-radius:12px;
  background:rgba(0,0,0,.16);
  cursor:pointer;
  user-select:none;
}
.kv:hover{
  border-color: rgba(110,210,255,.35);
  box-shadow: 0 0 14px rgba(110,210,255,.18);
}
.kv b{
  font-weight:900;
  letter-spacing:.4px;
  color:#e9fdff;
}
.kv span{ color:#d0fbff; font-weight:800; }

.pill{
  display:inline-block;
  font-size:11px;
  padding:6px 10px;
  border-radius:999px;
  border:1px solid rgba(110,210,255,.18);
  background:rgba(0,0,0,.14);
  margin-top:10px;
  opacity:.95;
}

/* ===== COLUNA DIREITA (Token + Telemetria) ===== */
#rightWrap{
  position:fixed;
  right:16px;
  top:16px;
  width:360px;
  z-index:10;

  display:flex;
  flex-direction:column;
  gap:12px;
}

#rightPanel{
  padding:14px;
  border-radius:18px;
}

.title{
  font-weight:900;
  letter-spacing:.6px;
  color:#e9fdff;
  margin-bottom:8px;
}

label{ display:block; font-size:12px; color:var(--muted); margin:10px 0 6px; }
.row{ display:flex; gap:10px; align-items:center; flex-wrap:wrap; }

input{
  width:170px;
  padding:10px 10px;
  border-radius:12px;
  border:1px solid rgba(110,210,255,.38);
  background:rgba(0,0,0,.18);
  color:#e9fbff;
  outline:none;
}
input:focus{
  border-color: rgba(110,210,255,.65);
  box-shadow: 0 0 16px rgba(110,210,255,.18);
}

.btn{
  background:linear-gradient(180deg,rgba(110,210,255,.18),rgba(0,0,0,.14));
  border:1px solid rgba(110,210,255,.45);
  color:#eafcff;
  border-radius:14px;
  padding:10px 14px;
  cursor:pointer;
  font-weight:800;
}
.btn:hover{ box-shadow:0 0 18px rgba(110,210,255,.30); }
.btn.secondary{ opacity:.95; }

.valueLine{ margin-top:10px; font-size:12px; color:#bdf4ff; }
.valueLine b{ font-size:18px; color:#e9fdff; }
.note{ margin-top:6px; font-size:11px; color:var(--muted); opacity:.95; }

/* ===== TELEMETRIA (sempre visível) ===== */
#telemetry{
  padding:10px 14px;
  border-radius:18px;
}
#telemetryTitle{
  font-size:11px;
  letter-spacing:.8px;
  color:#d4fbff;
  opacity:.95;
  margin-bottom:6px;
}
#wave{
  width:100%;
  height:44px;
  display:block;
  filter: drop-shadow(0 0 8px rgba(110,210,255,.55));
}

/* ===== MODAL ===== */
#modalOverlay{
  position:fixed; inset:0;
  background: rgba(0,0,0,.45);
  backdrop-filter: blur(2px);
  display:none;
  z-index:50;
}
#modal{
  position:fixed;
  left:50%; top:50%;
  transform:translate(-50%,-50%);
  width:min(520px, 92vw);
  padding:16px;
  border-radius:18px;
  z-index:60;
  display:none;
}
#modal h3{ margin:0 0 6px; letter-spacing:.6px; }
#modal .mtext{ color:#c9f7ff; font-size:13px; line-height:1.35; }
#modal .closeRow{ display:flex; justify-content:flex-end; margin-top:12px; }

/* ===== RESPONSIVO ===== */
@media (max-width: 1100px){
  #leftPanel{ width:340px; }
  #rightWrap{ width:340px; }
  #bg{ transform: translateY(32px) scale(.84); }
}
@media (max-width: 900px){
  body{ overflow:auto; }
  #leftPanel{ position:static; width:auto; margin:12px; }
  #header{ position:static; transform:none; margin:12px; }
  #rightWrap{ position:static; width:auto; margin:12px; }
  #stage{ position:relative; height:55vh; }
  #bg{ transform: translateY(0) scale(.95); }
}
</style>
</head>

<body>

<!-- MAPA -->
<div id="stage">
  <img id="bg" src="./mapa_br.png" alt="Mapa CNT Brasil">
  <div id="mapGlow"></div>
  <div id="scanlines"></div>
  <div id="dust"></div>
</div>

<!-- HEADER -->
<div id="header" class="glass">
  <div class="t1">CNT — Ativo Ambiental</div>
  <div class="t2">Crédito ecológico dinâmico: monitoramento + lastro de conservação + registro público</div>
</div>

<!-- ESQUERDA -->
<div id="leftPanel" class="glass">
  <div class="small">
    <strong>CNT (Solana)</strong>: reserva ambiental tokenizada para financiar conservação e registrar ordens de aquisição/monitoramento.
  </div>

  <div class="big" id="cnt">68.0</div>
  <div class="small">Classificação ambiental: <strong>Moderada</strong></div>

  <div class="divider"></div>

  <div class="small">Status do território:</div>
  <div><strong>Funcional e estável</strong></div>
  <div class="small">Modo: Monitoramento ativo</div>
  <div class="small">Auditoria: Telemetria temporal (30D)</div>

  <div class="divider"></div>

  <div style="font-weight:900; letter-spacing:.5px; font-size:13px;">Índices (clique para ver)</div>

  <div class="grid2">
    <div class="kv" data-k="IBE"><b>IBE</b><span id="ibe">88</span></div>
    <div class="kv" data-k="IAB"><b>IAB</b><span id="iab">88</span></div>
    <div class="kv" data-k="IBI"><b>IBI</b><span id="ibi">11</span></div>
    <div class="kv" data-k="HID"><b>HID</b><span id="hid">83</span></div>
    <div class="kv" data-k="ENT"><b>ENT</b><span id="ent">88</span></div>
    <div class="kv" data-k="PAN"><b>PAN</b><span id="pan">78</span></div>
  </div>

  <div class="pill">
    Nota: ENT e PAN atuam como fatores de ajuste (penalidades/pressões) e modulam o CNT final junto aos demais índices.
  </div>
</div>

<!-- DIREITA: Compra + Telemetria -->
<div id="rightWrap">
  <div id="rightPanel" class="glass">
    <div class="title">ADQUIRIR CNT (RESERVA AMBIENTAL)</div>

    <label for="sol">Valor em SOL</label>
    <div class="row">
      <input id="sol" type="number" step="0.01" min="0" value="0.10" />
      <button class="btn secondary" onclick="connect()">Conectar Wallet</button>
      <button class="btn" onclick="buy()">Comprar</button>
    </div>

    <div class="valueLine">
      Você recebe aprox: <b id="out">14.744.913 CNT</b>
    </div>

    <div class="note">Rede: Solana • Compra abre Pump.fun.</div>
  </div>

  <div id="telemetry" class="glass">
    <div id="telemetryTitle">TELEMETRIA — OSCILAÇÃO FUNCIONAL (30D)</div>
    <canvas id="wave"></canvas>
  </div>
</div>

<!-- MODAL -->
<div id="modalOverlay"></div>
<div id="modal" class="glass">
  <h3 id="mTitle">IBE</h3>
  <div class="mtext" id="mText"></div>
  <div class="closeRow">
    <button class="btn secondary" id="closeBtn">Fechar</button>
  </div>
</div>

<script>
/* ===== FIX IMAGEM (GitHub Pages) ===== */
(function(){
  const bg = document.getElementById("bg");
  const base = "./mapa_br.png";
  if(!bg) return;

  bg.src = base + "?v=" + Date.now();

  bg.addEventListener("load", () => console.log("OK: mapa carregou:", bg.src));
  bg.addEventListener("error", () => {
    console.error("ERRO: não encontrei:", base);
    alert("ERRO: não achei ./mapa_br.png. Coloque o arquivo na MESMA pasta do index.html e com o nome EXATO.");
  });
})();

/* ===== Telemetria ===== */
const canvas = document.getElementById("wave");
const ctx = canvas.getContext("2d");

function resize(){
  const dpr = Math.max(1, window.devicePixelRatio || 1);
  canvas.width = Math.floor(canvas.clientWidth * dpr);
  canvas.height = Math.floor(canvas.clientHeight * dpr);
  ctx.setTransform(dpr,0,0,dpr,0,0);
}
window.addEventListener("resize", resize);
resize();

let tt=0;
function draw(){
  const w = canvas.clientWidth;
  const h = canvas.clientHeight;

  ctx.fillStyle = "rgba(0,18,38,.18)";
  ctx.fillRect(0,0,w,h);

  ctx.strokeStyle = "#6fe0ff";
  ctx.lineWidth = 2;
  ctx.beginPath();

  for(let i=0;i<w;i++){
    const y =
      (h*0.58)
      + Math.sin((i+tt)/38)*(h*0.22)
      + Math.sin((i+tt)/13)*(h*0.08);

    if(i===0) ctx.moveTo(i,y);
    else ctx.lineTo(i,y);
  }
  ctx.stroke();

  tt += 2;
  requestAnimationFrame(draw);
}
draw();

/* ===== Conversão DEMO ===== */
const rate = 147449130; // 1 SOL -> CNT (demo)
const solInput = document.getElementById("sol");
const out = document.getElementById("out");
function update(){
  const sol = parseFloat(solInput.value) || 0;
  out.textContent = (sol * rate).toLocaleString("pt-BR") + " CNT";
}
solInput.addEventListener("input", update);
update();

/* ===== Botões (placeholder) ===== */
function connect(){
  alert("Conexão Phantom/Solana entra aqui depois (ainda é DEMO).");
}
function buy(){
  window.open("https://pump.fun/coin/GCVyjNaCbXkwGUuktyNxSXad4ozmTp2fzQr2jieSpump","_blank");
}

/* ===== Modal Sub-índices ===== */
const meanings = {
  IBE: "Índice Bioelétrico: pulso/atividade elétrica do sistema vivo (metabolismo ecológico).",
  IAB: "Índice Abiótico: condições físicas (clima, solo, energia) que sustentam o sistema.",
  IBI: "Índice Biótico: organização da vida (atividade biológica e padrão funcional).",
  HID: "Índice Hídrico: estabilidade e dinâmica da água no território.",
  ENT: "Entropia: perda de ordem/eficiência do sistema (penalidade/ajuste).",
  PAN: "Pressão Antrópica: intensidade do uso humano e impacto (penalidade/ajuste)."
};

const modal = document.getElementById("modal");
const overlay = document.getElementById("modalOverlay");
const mTitle = document.getElementById("mTitle");
const mText  = document.getElementById("mText");
const closeBtn = document.getElementById("closeBtn");

function openModal(key){
  mTitle.textContent = key;
  mText.textContent = meanings[key] || "Sem descrição.";
  overlay.style.display = "block";
  modal.style.display = "block";
}
function closeModal(){
  overlay.style.display = "none";
  modal.style.display = "none";
}
document.querySelectorAll(".kv").forEach(el=>{
  el.addEventListener("click", ()=> openModal(el.dataset.k));
});
overlay.addEventListener("click", closeModal);
closeBtn.addEventListener("click", closeModal);
</script>

</body>
</html>
